branches:
  only:
    - master
matrix:
  include:
    - language: node_js
      node_js:
        - stable
      cache:
        bundle: yarn
        directories:
          - node_modules
      before_script:
        - cd frontend
        - yarn install
      script:
        - yarn test
        - yarn run build:prod
      deploy:
        provider: s3
        access_key_id: $AWS_ACCESS_KEY_ID
        secret_access_key: $AWS_SECRET_ACCESS_KEY
        bucket: www.infodump.io
        skip_cleanup: true
        region: $S3_REGION
        local-dir: build
